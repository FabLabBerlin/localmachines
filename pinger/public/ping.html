<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Julius Webpage</title>
	<script src="jquery.min.js"></script>
    <script src="JSXTransformer.js"></script>
    <script src="react.js"></script>
    <link rel="stylesheet" href="/public/css/bootstrap.min.css">
    <link rel="stylesheet" href="/public/css/bootstrap-theme.min.css">
    <script src="/public/js/bootstrap.min.js"></script>
		
	<style>
	
	td.UP {
	    background-color: green;
	}
	td.DOWN {
		background-color: red;
	}
	</style>
</head>

<body>

	<div className="container" id="content"></div>

	<script type="text/jsx">
/*
if (foo) { console.log('bla'); } console.log('bla');
*/
		var PingerComponent = React.createClass({
			getInitialState: function() {
				return {
					response: undefined
				};
			},
			// "init"
			componentWillMount: function() {
				this.update();
				setInterval(function() {
					this.update();
				}.bind(this), 20000);
			},
			update: function() {
						$.ajax({
							url: '/get_list',
							type: 'GET',
							dataType: 'json',
							success: function(response){
								console.log(response);
								this.setState({
									data: response.status
								});
							}.bind(this),
							error: function(error){
								console.log(error);
							}
						});
			},
			render: function() {
				if (this.state.data && this.state.data[0]) {
					return (
							<table className="table table-striped">
						  		<thead>
							 		<tr>
						    	 		<th>Name</th>
						    	 		<th>Address</th>		
						 		 		<th>Status</th>
								 	</tr>
								</thead>
								<tbody>
							  	{this.state.data.map(function(bla, i) {
								 	return (
										
								  		<tr key={i}>
									 		<td>{bla.name}</td>
											<td>{bla.ip}</td>
											<td className={bla.status}>{bla.status}</td>
										</tr>
									);
								})}
								</tbody>
							</table>
					
					);
				} else {
					return (
						<div className="container">
							Loading...	
						</div>
					);
				}
			}
		});
		React.render(
			<div className="container">
				<h3>MACHINES STATUS</h3>
				<PingerComponent></PingerComponent>
			</div>, 

			document.getElementById('content'));
			
	</script>

</body>
</html>