<div class="container-fluid">

    <h1>Dashboard</h1>
    <h2>Metrics</h2>
    <h3>Revenue through Activations and Memberships</h3>
    <div id="chart_monthly">
      <div class="loader-local">
        <div class="spinner">
          <i class="fa fa-cog fa-spin"></i>
        </div>
      </div>
    </div>

    <h3>Daily Revenue through Activations</h3>
    <div id="chart_daily">
      <div class="loader-local">
        <div class="spinner">
          <i class="fa fa-cog fa-spin"></i>
        </div>
      </div>
    </div>

    <h3>Earnings by Machine</h3>
    <h4>Membership contributions weighted by undiscounted prices</h4>
    <div id="chart_machine_earnings">
      <div class="loader-local">
        <div class="spinner">
          <i class="fa fa-cog fa-spin"></i>
        </div>
      </div>
    </div>

    <h3>Usage by Machine</h3>
    <h4>Total lifetime is the time since its first activation</h4>
    <div id="chart_machine_capacities">
      <div class="loader-local">
        <div class="spinner">
          <i class="fa fa-cog fa-spin"></i>
        </div>
      </div>
    </div>

    <h3>Customer Retention</h3>
    <h4>Excludes users that currently have Admin rights</h4>
    <label>
      <input type="checkbox" ng-model="activeOnly"> Show only users that did at least one purchase
    </label>
    <div class="loader-local" ng-hide="retention || activeOnly">
      <div class="spinner">
        <i class="fa fa-cog fa-spin"></i>
      </div>
    </div>
    <div id="customer_retention" ng-show="retention && !activeOnly">
      <table class="table">
        <thead>
          <tr>
            <th colspan="2" class="text-right">
              Signups
            </th>
            <th colspan="{{retention[0].Returns.length}}" class="text-center">
              Months later
            </th>
          </tr>
          <tr>
            <th class="text-center">
              From
            </th>
            <th class="text-center">
              #
            </th>
            <th ng-repeat="r in retention[0].Returns track by $index" class="text-center">
              {{$index + 1}}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="row in retention">
            <td>
              <b>{{row.From}}</b>
            </td>
            <td>
              {{row.Users}}
            </td>
            <td ng-repeat="r in row.Returns track by $index" class="retention {{retentionClass(r)}}">
              <b>{{formatPercentage(r)}}%</b>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="loader-local" ng-hide="retentionActive || !activeOnly">
      <div class="spinner">
        <i class="fa fa-cog fa-spin"></i>
      </div>
    </div>
    <div id="customer_retention" ng-show="retentionActive && activeOnly">
      <table class="table">
        <thead>
          <tr>
            <th colspan="2" class="text-right">
              Signups
            </th>
            <th colspan="{{retentionActive[0].Returns.length}}" class="text-center">
              Months later
            </th>
          </tr>
          <tr>
            <th class="text-center">
              From
            </th>
            <th class="text-center">
              #
            </th>
            <th ng-repeat="r in retentionActive[0].Returns track by $index" class="text-center">
              {{$index + 1}}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="row in retentionActive">
            <td>
              <b>{{row.From}}</b>
            </td>
            <td>
              {{row.Users}}
            </td>
            <td ng-repeat="r in row.Returns track by $index" class="retention {{retentionActiveClass(r)}}">
              <b>{{formatPercentage(r)}}%</b>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
</div>
